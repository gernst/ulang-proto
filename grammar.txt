grammar base
  id = Id '[a-zA-Z]';

grammar mixfix
  level op inner
    = Level (inner op ... inner);

  levels [] inner
    = inner;

  levels (op :: tighter) inner
    = level op (levels tighter inner);


grammar expr

case == Case expr '->' expr;
cases == '|' ... case;

ite == IfThenElse 'if' expr 'then' expr 'else' expr;
let == Let 'let' expr '=' expr 'in' expr

app == App closed closed*;

ops == ['[+-]', '[*/]'];
    
mixfix == levels ops app;

expr == mixfix;
